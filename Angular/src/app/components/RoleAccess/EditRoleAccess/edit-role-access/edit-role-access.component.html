<div class="container" style="background-color: rgb(253, 253, 253);border-radius: 15px;">
    <div class="table-wrapper">
        <div class="table-title">
            <br>
            <div class="row">
                <div class="col-sm-8">
                    <h4>Role Based Access Control</h4>
                </div>
                <div *ngIf="loading" class="loading-spinner">
                    <!-- Show loading spinner while data is being fetched -->
                    <div class="spinner-border text-primary" role="status">
                      <span class="visually-hidden">Loading...</span>
                </div>   
            </div>
        </div>
        
        <div class="row mb-3 ml-2">

            <a routerLink="/RoleAccessList" *ngIf="!loading">
                <i  class="flaticon2-arrow-2 text-dark"  ></i> 
              </a>
        </div>

        <form [formGroup]="roleForm" (ngSubmit)="PostrbacData()" *ngIf="!loading">
            <table class="table table-borderless">
              <thead>
                <tr>
                  <th>Document</th>
                  <th>Select</th>
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let document of Accessdata; let i = index">
                  <tr>
                    <td>
                      {{ document.documentmasterfield }}
                      <div *ngIf="document.parentChildData && document.parentChildData.length > 0">
                        <table class="table table-borderless">
                          <tr *ngFor="let child of document.parentChildData; let j = index">
                            <td>{{ child.text }}</td>
                          </tr>
                        </table>
                      </div>
                    </td>
                    <td >
                        <div *ngIf="document.flag ; else checkBox">
                          <input type="checkbox" [checked]="document.flag" #checkboxRef id="{{document.documentid}}" (change)="checkboxChange($event, document.documentid)">
                        </div>
                        <ng-template #checkBox>
                          <input type="checkbox"  #checkboxRef id="{{document.documentid}}" (change)="checkboxChange($event, document.documentid)">
                        </ng-template>
                        <div *ngIf="document.parentChildData && document.parentChildData.length > 0">
                          <table class="table table-borderless">
                            <tr *ngFor="let child of document.parentChildData; let j = index">
                              <div *ngIf="child.disabled; else childCheckBox">
                                <input type="checkbox" [checked]="child.disabled" #childCheckboxRef id="{{child.value}}" (change)="childCheckboxChange($event, document.documentid, child.value)">
                              </div>   
                              <ng-template #childCheckBox>
                                <input type="checkbox"  #childCheckboxRef id="{{child.value}}" (change)="childCheckboxChange($event, document.documentid, child.value)">
                              </ng-template>                    
                            </tr>
                          </table>
                        </div>
                    </td>
                  </tr>
                  
                </ng-container>
              </tbody>
            </table>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
    </div>
</div>

<!-- <tr>
                        <td>{{rol?.documentmasterfield}}
                        <tr>
                            <th *ngIf="rol?.parentChildData > 0">Sub-Child Access</th>
                        </tr>
                        </td>

                        <td>
                            <input class="form-check-input mt-0" type="checkbox" [formControlName]="'checkbox_' + i+1"
                            [formControlName]="'checkbox_' + rol.documentid"
                            (change)="onCheckboxChange(rol.documentid)"
                            [checked]="roleForm.get('checkbox_' + rol.documentid)?.value"
                                aria-label="Checkbox for following text input"
                                style="border: solid black; height: 15px; width: 15px; margin-left: 20px;">
                                
                        </td>
                    </tr>  [formControlName]="subItem.value" (change)="checkSubField(i)" -->
<!-- 
                    <table class="table table-bordered" *ngIf="!loading">
                        <thead>
                          <tr>
                            <th>Form Name</th>
                            <th>Access Type</th>
                          </tr>
                        </thead>
                        <tbody>
                            <ng-container *ngFor="let rol of Accessdata; let i = index">
                              <tr>
                                <td>{{ rol?.documentmasterfield }}
                                    <ng-container *ngIf="rol?.parentChildData.length > 0">
                                        <div *ngFor="let subItem of rol.parentChildData; let j = index">
                                          <label>
                                            {{ subItem.text }}
                                          </label>
                                        </div>
                                      </ng-container>
            
                                </td>
                                <td>
                                  <div [formGroup]="roleForm">
                                    <input type="checkbox" [formControlName]="'parent_' + rol.roleid">   
                                    <ng-container *ngIf="rol?.parentChildData.length > 0">
                                      <div *ngFor="let subItem of rol.parentChildData; let j = index">                            
                                          <input type="checkbox" [formControlName]="'subField_' + subItem.value">                              
                                      </div>
                                    </ng-container>
                                  </div>
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                      </table> -->